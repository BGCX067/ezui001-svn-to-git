<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="ipay_user_payment_log" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    <result column="ID" property="id" jdbcType="BIGINT" />
    <result column="IPAY_USER_ID" property="ipayUserId" jdbcType="VARCHAR" />
    <result column="USER_ID" property="userId" jdbcType="VARCHAR" />
    <result column="APP_ID" property="appId" jdbcType="VARCHAR" />
    <result column="VERSION_ID" property="versionId" jdbcType="INTEGER" />
    <result column="PAYMENT_TYPE" property="paymentType" jdbcType="INTEGER" />
    <result column="PAY_TIME" property="payTime" jdbcType="TIMESTAMP" />
    <result column="AMOUNT" property="amount" jdbcType="DOUBLE" />
    <result column="IPAY_TOKEN" property="ipayToken" jdbcType="VARCHAR" />
    <result column="ICCID" property="iccid" jdbcType="VARCHAR" />
    <result column="IMEI" property="imei" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="INTEGER" />
    <result column="MY_PRICE_TYPE" property="myPriceType" jdbcType="VARCHAR" />
    <result column="RET_CODE" property="retCode" jdbcType="VARCHAR" />
    <result column="RIGHT_START_DATE" property="rightStartDate" jdbcType="TIMESTAMP" />
    <result column="RIGHT_END_DATE" property="rightEndDate" jdbcType="TIMESTAMP" />
    <result column="LAST_VERSION_ID" property="lastVersionId" jdbcType="INTEGER" />
    <result column="SERVICE_ID" property="serviceId" jdbcType="VARCHAR" />
    <result column="CANCEL_SRC_TYPE" property="cancelSrcType" jdbcType="INTEGER" />
    <result column="USER_UID" property="userUid" jdbcType="VARCHAR" />
    <result column="DOWNLOAD_ID" property="downloadId" jdbcType="BIGINT" />
    <result column="CANCEL_TIME" property="cancelTime" jdbcType="TIMESTAMP" />
    <result column="PAYMENT_ID" property="paymentId" jdbcType="VARCHAR" />
    <result column="RET_CODE_API_NAME" property="retCodeApiName" jdbcType="VARCHAR" />
    <result column="STORE_ID" property="storeId" jdbcType="BIGINT" />
    <result column="SUBSTORE_OID" property="substoreOid" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ibatorgenerated_ResultMapWithBLOBs" class="cn.vstore.appserver.model.IpayUserPaymentLog" extends="ipay_user_payment_log.ibatorgenerated_BaseResultMap" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    <result column="RET_MSG" property="retMsg" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="ibatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_ResultMapWithBLOBs" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    select ID, IPAY_USER_ID, USER_ID, APP_ID, VERSION_ID, PAYMENT_TYPE, PAY_TIME, AMOUNT,
      IPAY_TOKEN, ICCID, IMEI, STATUS, MY_PRICE_TYPE, RET_CODE, RIGHT_START_DATE, RIGHT_END_DATE,
      LAST_VERSION_ID, SERVICE_ID, CANCEL_SRC_TYPE, USER_UID, DOWNLOAD_ID, CANCEL_TIME, PAYMENT_ID,
      RET_CODE_API_NAME, STORE_ID, SUBSTORE_OID, RET_MSG
    from ipay_user_payment_log
    where ID = #id:BIGINT#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    delete from ipay_user_payment_log
    where ID = #id:BIGINT#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    insert into ipay_user_payment_log (IPAY_USER_ID, USER_ID, APP_ID, VERSION_ID, PAYMENT_TYPE,
      PAY_TIME, AMOUNT, IPAY_TOKEN, ICCID, IMEI, STATUS, MY_PRICE_TYPE, RET_CODE, RIGHT_START_DATE,
      RIGHT_END_DATE, LAST_VERSION_ID, SERVICE_ID, CANCEL_SRC_TYPE, USER_UID, DOWNLOAD_ID,
      CANCEL_TIME, PAYMENT_ID, RET_CODE_API_NAME, STORE_ID, SUBSTORE_OID, RET_MSG)
    values (#ipayUserId:VARCHAR#, #userId:VARCHAR#, #appId:VARCHAR#, #versionId:INTEGER#,
      #paymentType:INTEGER#, #payTime:TIMESTAMP#, #amount:DOUBLE#, #ipayToken:VARCHAR#,
      #iccid:VARCHAR#, #imei:VARCHAR#, #status:INTEGER#, #myPriceType:VARCHAR#, #retCode:VARCHAR#,
      #rightStartDate:TIMESTAMP#, #rightEndDate:TIMESTAMP#, #lastVersionId:INTEGER#,
      #serviceId:VARCHAR#, #cancelSrcType:INTEGER#, #userUid:VARCHAR#, #downloadId:BIGINT#,
      #cancelTime:TIMESTAMP#, #paymentId:VARCHAR#, #retCodeApiName:VARCHAR#, #storeId:BIGINT#,
      #substoreOid:VARCHAR#, #retMsg:LONGVARCHAR#)
    <selectKey resultClass="java.lang.Long" keyProperty="id" >
      SELECT LAST_INSERT_ID()
    </selectKey>
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    insert into ipay_user_payment_log
    <dynamic prepend="(" >
      <isNotNull prepend="," property="ipayUserId" >
        IPAY_USER_ID
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        USER_ID
      </isNotNull>
      <isNotNull prepend="," property="appId" >
        APP_ID
      </isNotNull>
      <isNotNull prepend="," property="versionId" >
        VERSION_ID
      </isNotNull>
      <isNotNull prepend="," property="paymentType" >
        PAYMENT_TYPE
      </isNotNull>
      <isNotNull prepend="," property="payTime" >
        PAY_TIME
      </isNotNull>
      <isNotNull prepend="," property="amount" >
        AMOUNT
      </isNotNull>
      <isNotNull prepend="," property="ipayToken" >
        IPAY_TOKEN
      </isNotNull>
      <isNotNull prepend="," property="iccid" >
        ICCID
      </isNotNull>
      <isNotNull prepend="," property="imei" >
        IMEI
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS
      </isNotNull>
      <isNotNull prepend="," property="myPriceType" >
        MY_PRICE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="retCode" >
        RET_CODE
      </isNotNull>
      <isNotNull prepend="," property="rightStartDate" >
        RIGHT_START_DATE
      </isNotNull>
      <isNotNull prepend="," property="rightEndDate" >
        RIGHT_END_DATE
      </isNotNull>
      <isNotNull prepend="," property="lastVersionId" >
        LAST_VERSION_ID
      </isNotNull>
      <isNotNull prepend="," property="serviceId" >
        SERVICE_ID
      </isNotNull>
      <isNotNull prepend="," property="cancelSrcType" >
        CANCEL_SRC_TYPE
      </isNotNull>
      <isNotNull prepend="," property="userUid" >
        USER_UID
      </isNotNull>
      <isNotNull prepend="," property="downloadId" >
        DOWNLOAD_ID
      </isNotNull>
      <isNotNull prepend="," property="cancelTime" >
        CANCEL_TIME
      </isNotNull>
      <isNotNull prepend="," property="paymentId" >
        PAYMENT_ID
      </isNotNull>
      <isNotNull prepend="," property="retCodeApiName" >
        RET_CODE_API_NAME
      </isNotNull>
      <isNotNull prepend="," property="storeId" >
        STORE_ID
      </isNotNull>
      <isNotNull prepend="," property="substoreOid" >
        SUBSTORE_OID
      </isNotNull>
      <isNotNull prepend="," property="retMsg" >
        RET_MSG
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="ipayUserId" >
        #ipayUserId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        #userId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appId" >
        #appId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="versionId" >
        #versionId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="paymentType" >
        #paymentType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="payTime" >
        #payTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="amount" >
        #amount:DOUBLE#
      </isNotNull>
      <isNotNull prepend="," property="ipayToken" >
        #ipayToken:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="iccid" >
        #iccid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="imei" >
        #imei:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="myPriceType" >
        #myPriceType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retCode" >
        #retCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rightStartDate" >
        #rightStartDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="rightEndDate" >
        #rightEndDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="lastVersionId" >
        #lastVersionId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="serviceId" >
        #serviceId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cancelSrcType" >
        #cancelSrcType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="userUid" >
        #userUid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="downloadId" >
        #downloadId:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="cancelTime" >
        #cancelTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="paymentId" >
        #paymentId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retCodeApiName" >
        #retCodeApiName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="storeId" >
        #storeId:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="substoreOid" >
        #substoreOid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retMsg" >
        #retMsg:LONGVARCHAR#
      </isNotNull>
      )
    </dynamic>
    <selectKey resultClass="java.lang.Long" keyProperty="id" >
      SELECT LAST_INSERT_ID()
    </selectKey>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    update ipay_user_payment_log
    <dynamic prepend="set" >
      <isNotNull prepend="," property="ipayUserId" >
        IPAY_USER_ID = #ipayUserId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        USER_ID = #userId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appId" >
        APP_ID = #appId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="versionId" >
        VERSION_ID = #versionId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="paymentType" >
        PAYMENT_TYPE = #paymentType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="payTime" >
        PAY_TIME = #payTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="amount" >
        AMOUNT = #amount:DOUBLE#
      </isNotNull>
      <isNotNull prepend="," property="ipayToken" >
        IPAY_TOKEN = #ipayToken:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="iccid" >
        ICCID = #iccid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="imei" >
        IMEI = #imei:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="myPriceType" >
        MY_PRICE_TYPE = #myPriceType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retCode" >
        RET_CODE = #retCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rightStartDate" >
        RIGHT_START_DATE = #rightStartDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="rightEndDate" >
        RIGHT_END_DATE = #rightEndDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="lastVersionId" >
        LAST_VERSION_ID = #lastVersionId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="serviceId" >
        SERVICE_ID = #serviceId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cancelSrcType" >
        CANCEL_SRC_TYPE = #cancelSrcType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="userUid" >
        USER_UID = #userUid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="downloadId" >
        DOWNLOAD_ID = #downloadId:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="cancelTime" >
        CANCEL_TIME = #cancelTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="paymentId" >
        PAYMENT_ID = #paymentId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retCodeApiName" >
        RET_CODE_API_NAME = #retCodeApiName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="storeId" >
        STORE_ID = #storeId:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="substoreOid" >
        SUBSTORE_OID = #substoreOid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="retMsg" >
        RET_MSG = #retMsg:LONGVARCHAR#
      </isNotNull>
    </dynamic>
    where ID = #id:BIGINT#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="cn.vstore.appserver.model.IpayUserPaymentLog" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Fri Jul 29 10:11:32 CST 2011.
    -->
    update ipay_user_payment_log
    set IPAY_USER_ID = #ipayUserId:VARCHAR#,
      USER_ID = #userId:VARCHAR#,
      APP_ID = #appId:VARCHAR#,
      VERSION_ID = #versionId:INTEGER#,
      PAYMENT_TYPE = #paymentType:INTEGER#,
      PAY_TIME = #payTime:TIMESTAMP#,
      AMOUNT = #amount:DOUBLE#,
      IPAY_TOKEN = #ipayToken:VARCHAR#,
      ICCID = #iccid:VARCHAR#,
      IMEI = #imei:VARCHAR#,
      STATUS = #status:INTEGER#,
      MY_PRICE_TYPE = #myPriceType:VARCHAR#,
      RET_CODE = #retCode:VARCHAR#,
      RIGHT_START_DATE = #rightStartDate:TIMESTAMP#,
      RIGHT_END_DATE = #rightEndDate:TIMESTAMP#,
      LAST_VERSION_ID = #lastVersionId:INTEGER#,
      SERVICE_ID = #serviceId:VARCHAR#,
      CANCEL_SRC_TYPE = #cancelSrcType:INTEGER#,
      USER_UID = #userUid:VARCHAR#,
      DOWNLOAD_ID = #downloadId:BIGINT#,
      CANCEL_TIME = #cancelTime:TIMESTAMP#,
      PAYMENT_ID = #paymentId:VARCHAR#,
      RET_CODE_API_NAME = #retCodeApiName:VARCHAR#,
      STORE_ID = #storeId:BIGINT#,
      SUBSTORE_OID = #substoreOid:VARCHAR#
    where ID = #id:BIGINT#
  </update>
  
  <select id="getStatus" parameterClass="java.util.HashMap" resultClass="java.lang.Integer" >
  	select STATUS  from IPAY_USER_PAYMENT_LOG where (MY_PRICE_TYPE = '1' or MY_PRICE_TYPE = '3') and APP_ID=#appId# and upper(USER_ID)=upper(#userId#) and IMEI=#imei# and store_id=#storeId#
  	order by ID desc limit 1
  </select>
  
  
</sqlMap>